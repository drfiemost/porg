.\"----------------------------------------------------------------
.\" porg.8 - porg-@PACKAGE_VERSION@ man page
.\"----------------------------------------------------------------
.\" Copyright (C) 2004-2012 David Ricart <@PACKAGE_BUGREPORT@>
.\" For more information visit  http://porg.sourceforge.net
.\"----------------------------------------------------------------
.\"
.TH PORG "8" "@RELEASEDATE@" "porg-@PACKAGE_VERSION@" "System"
.SH NAME
porg \- a source code package organizer
.SH SYNOPSIS
\fBporg\fR [OPTIONS] <packages>
.br
\fBporg\fR \-l [OPTIONS] <package> <command>
.br
\fBporg\fR -q <files>
.SH DESCRIPTION
.PP
Porg is a program to aid package management when installing packages from source
code.
.PP
When installing a package, porg can be used in log mode (with option \fB\-l\fR)
to wrap the installation command (e.g. "make install"), and log the created
files. By default the log is stored in directory '@LOGDIR@'.
.PP
Once some packages are installed and properly registered, porg can be used in list
mode, which is the default, to display package information. Several options
are provided to print the information in different formats.
.PP
There are also options for removing packages, printing the configure options the
package was installed with, or querying for the package that owns one or more files.
.PP
Mandatory arguments to long options are mandatory for short options too.
.PP
The special option \fB\-\-\fR forces and end of option-scanning. This is
specially useful when entering the install command in log mode.
.SH GENERAL OPTIONS
.TP
\fB\-h, \-\-help\fR
Display a help message and exit.
.TP
\fB\-L, \-\-logdir\fR=\fIDIR\fR
Base log directory. Default is '@LOGDIR@', unless variable LOGDIR is set
in the configuration file (type 'man porgrc' for more information).
.TP
\fB\-v, \-\-verbose\fR
Verbose output. \fB\-vv\fR prints also debugging messages.
.TP
\fB\-V, \-\-version\fR
Display version information and exit.
.SH PACKAGE INFORMATION OPTIONS
.TP
\fB\-a, \-\-all\fR
Apply to all installed packages.
.TP
\fB\-b, \-\-block\-size\fR=\fISIZE\fR
With \fB\-s\fR, use blocks of SIZE bytes for the sizes. SIZE may be an integer, 
optionally followed by one of the following: k, K, m, M.
.TP
\fB\-d, \-\-date\fR
Print the installation date of the package. Double it ('\fB\-dd\fR') to print
also the hour.
.TP
\fB\-f, \-\-files\fR
Print the installed files of the package.
.TP
\fB\-F\fR
Print the number of installed files.
.TP
\fB\-i, \-\-info\fR
Print package information. Note that information may be not available 
for all packages.
.TP
\fB\-k, \-\-kilobytes\fR
Like '--block-size=1k', or '--block-size=1024'.
.TP
\fB\-o, \-\-configure\-options\fR
Print the configure options the package was built with.
.TP
\fB\-q, \-\-query\fR
Query for the packages that own one or more files.
.TP
\fB\-R, \-\-reverse\fR
Reverse order while sorting.
.TP
\fB\-s, \-\-size\fR
Show the size of each package or file; in human readable format by
default (e.g. 1.2M, 13k).
.TP
\fB\-\-sort\fR=\fIWORD\fR
Sort the list by WORD: When listing files, meaningful values for WORD
are: 'name' and 'size'. When listing packages, WORD may be
also: 'date' (or 'time') or 'files'.
.TP
\fB\-t, \-\-total\fR
Print totals at the bottom of the list, when appliable.
.TP
\fB\-y, \-\-symlinks\fR
With \fB\-f\fR, print the contents of symbolic links.
.TP
\fB\-z, \-\-no\-package\-name\fR
With \fB\-f\fR, do not print the name of the package. Useful for scripts.
.SH LOG OPTIONS
.TP
\fB\-l, \-\-log\fR
Enable log mode: If a shell command is given as an argument, execute
and monitor it, logging the created files, otherwise the list of files
to log is read from the standard input.
.br
The list of logged files is printed to the standard output, unless
any of \fB\-p\fR or \fB\-D\fR options is used, in which case is assumed
that a package is to be logged in the porg database.
.br
When a shell comand is monitorized, porg returns the exit code of that
command.
.br
See EXAMPLES below.
.TP
\fB\-p, \-\-package\fR=\fIPKG\fR
Specify the name of the package to log, which must begin with
an alphanumeric character. With \fB\-v\fR, the list of logged files
is also printed to the standard error stream. With \fB\-vv\fR,
porg prints detailed information about the install process. This
holds for option \fB\-D\fR too.
.TP
\fB\-D, \-\-dirname\fR
Use the name of the current directory as the name of the package to be logged.
.TP
\fB\-E, \-\-exclude\fR=\fIPATH1:PATH2:...\fR
Colon-separated list of paths to skip when logging. Default is '@EXCLUDE@',
unless variable EXCLUDE is set in the
configuration file (type 'man porgrc' for more information).
.br
Shell wildcards are allowed in the PATHs. See \fIPATH MATCHING\fR below for
more details.
.TP
\fB\-I, \-\-include\fR=\fIPATH1:PATH2:...\fR
Colon-separated list of paths to scan when logging. Default is '@INCLUDE@',
unless variable INCLUDE is set in the
configuration file (type 'man porgrc' for more information).
.br
Shell wildcards are allowed in the PATHs. See \fIPATH MATCHING\fR below for
more details.
.TP
\fB\-\-ignore\-errors\fR
Do not exit if the install command fails. This allows for logging
uncomplete installations, and cleanup the system upon an installation
failure. Errors are not ignored by default.
.TP
\fB\-\-log\-missing\fR
By default, when installing a package porg registers only those files 
that exist in the filesystem right after the installation. Using this
option, porg registers also the missing files. See \fIEXAMPLES\fR
below.
.TP
\fB\-+, \-\-append\fR
With \fB\-p\fR or \fB\-D\fR, if the package is already logged, append the list
of files to its log.
.SH REMOVE OPTIONS
.TP
\fB\-r, \-\-remove\fR
Remove a package, keeping the shared files and asking for confirmation by
default. If the option is doubled (\fB\-rr\fR), or all logged files are
successfully removed, the package is removed from the database.
.TP
\fB\-B, \-\-batch\fR
Don't prompt for confirmation when removing (and assume yes to all questions).
.TP
\fB\-e, \-\-skip\fR=\fIPATH1:PATH2:...\fR
Colon-separated list of paths to skip when removing a package. 
Default is '' (all logged files are removed),
unless variable REMOVE_SKIP is set in the
configuration file (type 'man porgrc' for more information).
.br
Shell wildcards are allowed in the PATHs. See \fIPATH MATCHING\fR below for
more details.
.TP
\fB\-U, \-\-unlog\fR
Remove the log of the package from the database, without removing any file.
.SH PATH MATCHING
Options \fB\-I\fR, \fB\-E\fR and \fB\-e\fR accept a colon-separated list of
paths, each of which may contain shell-like wildcards (*, ? and [..]).
Files are matched against each of those paths, following the standard
shell-like expansion, but with the following exception: If a path in the list
does not contain any wildcard, and it is a directory, it matches any file
within that directory.
.br
Note that if wildcards are to be used, the whole list of paths must be enclosed
in single quotes (') to protect it from being expanded by the shell.
.SH EXAMPLES
To log the installation of the package 'foo-1.0', which is installed
with the command 'make -C src install':
.PP
    porg -lp foo-1.0 "make -C src install"
.PP 
Note that in this example the quotes are required to prevent
porg to consider '-C' as a command line option.
The special end-of-option argument '--' may be used for the same purpose:
.PP
    porg -lp foo-1.0 -- make -C src install
.PP
Use single quotes if the command already contains double quotes:
.PP
	porg -lp foo-1.0 'echo "hello world" > /var/log/foo.log'
.PP
Alternatively, we can use the basename of the current directory as the name of
the package to log, using the option \fB\-D\fR instead of \fB\-p\fR:
.PP
    porg -lD "make install && make install.man"
.PP
If we have forgotten to install a file, it can be added to a previously
created log with the option \fB\-+\fR:
.PP
    porg -lp+ foo-1.0 "install foo /bin/foo"
.PP
Note that the option \fB-+\fR cannot be used to remove a file from the
log. For instance, the following command:
.PP
    porg -lp+ foo-1.0 "rm /bin/foo"
.PP
would not remove the file /bin/foo from the log of foo-1.0.
.PP
To avoid such behaviour it is sometimes useful to join up composed
install commands into one single command and run porg once. For instance,
imagine that a package installs the file /bin/foo, but we want it to
be installed in /usr/bin/foo. If one runs this:
.PP
    porg -lp foo-1.0 make install
.br
    porg -lp+ foo-1.0 "mv /bin/foo /usr/bin/foo"
.PP
Both files, /bin/foo and /usr/bin/foo remain in the log. This is
usually not the desired behaviour. As a workaround one can join up
both commands in one single porg run:
.PP
    porg -lp foo-1.0 "make install && mv /bin/foo /usr/bin/foo"
.PP
In this case only /usr/bin/foo is logged.
.PP
To understand the meaning of the option \fB\-\-log\-missing\fR, consider
the following example, where the file /foo/bar does not exist:
.PP
    echo /foo/bar | porg --log-missing -lp foo
.PP
This would log the file /foo/bar, even if it is missing. Without the
option --log-missing /foo/bar is skipped.
.PP
To remove the package foo-3.3, keeping the files in /etc and the files
ending with ".conf":
.PP
    porg -r -e '/etc:*.conf' foo-3.3
.PP
We have installed the package 'boo-1.9' in prefix '/opt/boo-1.9', but
we haven't logged the installation with porg. No problem! Just create a log
for it thusly:
.PP
    find /opt/boo-1.9 | porg -lp boo-1.9

.SH BUGS
Due to LD_PRELOAD limitations, porg can't follow the trace of suid programs.
.br
For the same reason, porg does not work with programs that statically link libc.
.SH FILES
.PP
\fI@sysconfdir@/porgrc\fR - configuration file
.br
\fI@LOGDIR@\fR - default log directory
.SH WEB SITE
The latest version of porg should be always available at:
.br
	http://porg.sourceforge.net
.SH COPYRIGHT
Copyright (C) 2004-2012 David Ricart <@PACKAGE_BUGREPORT@>
.br
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
.SH SEE ALSO
porgrc(5), porgball(8), superporg(8)
